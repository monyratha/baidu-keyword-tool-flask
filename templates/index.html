<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>Baidu Keyword Extractor ü§ñ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code&family=JetBrains+Mono&display=swap');

        body {
            margin: 0;
            padding: 2rem;
            background: linear-gradient(135deg, #0f0f0f, #1c1c1e);
            font-family: 'Fira Code', monospace;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            color: #f0f0f0;
        }

        .container {
            width: 100%;
            max-width: 820px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            position: relative;
        }

        h1 {
            text-align: center;
            font-size: 2rem;
            font-weight: 500;
            background: linear-gradient(90deg, #00ffe0, #00b3ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 6px rgba(0, 255, 255, 0.2);
            margin-bottom: 2rem;
        }

        label {
            display: block;
            margin: 0.5rem 0 0.2rem;
            color: #ccc;
            font-size: 0.9rem;
        }

        textarea, input[type="text"] {
            width: 100%;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(0, 255, 255, 0.1);
            border-radius: 12px;
            padding: 10px 14px;
            color: #fff;
            font-size: 0.9rem;
            backdrop-filter: blur(12px);
            box-shadow: inset 0 0 10px rgba(0, 255, 255, 0.06);
            margin-bottom: 1rem;
            transition: 0.3s ease all;
        }

        textarea:focus, input:focus {
            outline: none;
            border-color: #00ffe0;
            box-shadow: 0 0 8px #00ffe088;
        }

        button {
            background: linear-gradient(135deg, #00ffe0, #00b3ff);
            color: #000;
            padding: 10px 20px;
            border: none;
            border-radius: 14px;
            font-weight: bold;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 0 12px rgba(0, 255, 255, 0.3);
            margin-top: 1rem;
            transition: all 0.25s ease;
        }

        button:hover {
            box-shadow: 0 0 20px #00ffe0aa;
            transform: scale(1.03);
        }

        #advanced {
            background: rgba(255, 255, 255, 0.03);
            padding: 1rem;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            margin-top: 1rem;
            display: none;
        }

        .saved-badge {
            color: #00ffd0;
            font-size: 0.75rem;
            margin-left: 6px;
        }

        .spinner {
            display: none;
            margin-top: 1rem;
            color: #00ffe0;
        }

        .toast {
            margin: 1rem 0;
            padding: 1rem;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(0, 255, 255, 0.2);
            color: #00ffe0;
            font-weight: 500;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.2);
        }

        .result-container {
            margin-top: 2rem;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.04);
            border-radius: 16px;
            border-left: 4px solid #00ffe0;
            backdrop-filter: blur(12px);
            box-shadow: 0 4px 30px rgba(0, 255, 255, 0.08);
            position: relative;
        }

        .result-block {
            margin-top: 1rem;
        }

        .result-block strong {
            color: #00ffe0;
            font-weight: 600;
            margin-bottom: 0.4rem;
            display: block;
        }

        ul {
            padding-left: 1.2rem;
        }

        ul li {
            font-family: 'JetBrains Mono', monospace;
            color: #ccffff;
            line-height: 1.4rem;
        }

        .copy-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(0, 255, 255, 0.3);
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 0.8rem;
            color: #00ffe0;
            cursor: pointer;
            transition: 0.2s ease;
        }

        .copy-btn:hover {
            background: rgba(0, 255, 255, 0.15);
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.3);
        }

        .copy-toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #00ffe0;
            color: #000;
            padding: 12px 20px;
            border-radius: 12px;
            font-weight: bold;
            box-shadow: 0 0 20px #00ffe088;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.4s ease;
            z-index: 999;
        }

        .copy-toast.show {
            opacity: 1;
            pointer-events: auto;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>ü§ñ Baidu Keyword Extractor</h1>

    {% with messages = get_flashed_messages() %}
    {% if messages %}
    {% for msg in messages %}
    <div class="toast">{{ msg }}</div>
    {% endfor %}
    {% endif %}
    {% endwith %}

    <form method="POST" onsubmit="saveCredentials()">
        <label>Keywords (one per line):</label>
        <textarea name="keywords" rows="6">{{ request.form.get('keywords', '') }}</textarea>

        <button type="button" id="toggle-advanced">üîê Configure Baidu Login</button>
        <div id="advanced">
            <label>BAIDUID:<span id="baiduid-saved" class="saved-badge"></span></label>
            <input type="text" id="baiduid" name="baiduid" required>

            <label>BDUSS:<span id="bduss-saved" class="saved-badge"></span></label>
            <input type="text" id="bduss" name="bduss" required>

            <label>BDORZ:<span id="bdorz-saved" class="saved-badge"></span></label>
            <input type="text" id="bdorz" name="bdorz" required>
        </div>

        <button type="submit">üß† Extract</button>
        <div class="spinner" id="spinner">‚è≥ Scraping Baidu‚Ä¶</div>
    </form>

    {% if results %}
    <div class="result-container" id="result-text">
        <button class="copy-btn" onclick="copyResults()">üìã Copy</button>
        <h3>Results:</h3>
        {% for kw, terms in results %}
        <div class="result-block">
            <strong>{{ kw }}</strong>
            <ul>
                {% for term in terms %}
                <li>{{ term }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endfor %}
    </div>
    {% endif %}
</div>

<div id="toast" class="copy-toast">‚úÖ Results copied to clipboard!</div>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const ids = ['baiduid', 'bduss', 'bdorz'];
        let hasSavedConfig = false;

        ids.forEach(id => {
            const input = document.getElementById(id);
            const badge = document.getElementById(id + '-saved');
            const stored = localStorage.getItem(id);
            if (stored && input && badge) {
                input.value = stored;
                badge.innerText = '‚úì';
                hasSavedConfig = true;
            }
        });

        const advanced = document.getElementById("advanced");
        const toggleBtn = document.getElementById("toggle-advanced");

        if (!hasSavedConfig && advanced) {
            advanced.style.display = "block";
        }

        if (toggleBtn) {
            toggleBtn.addEventListener("click", () => {
                const isVisible = advanced.style.display === "block";
                advanced.style.display = isVisible ? "none" : "block";
            });
        }
    });

    function saveCredentials() {
        const ids = ['baiduid', 'bduss', 'bdorz'];
        ids.forEach(id => {
            const val = document.getElementById(id).value;
            if (val) {
                localStorage.setItem(id, val);
                document.getElementById(id + '-saved').innerText = '‚úì';
            }
        });
        document.getElementById('spinner').style.display = 'block';
    }

    function copyResults() {
        const blocks = document.querySelectorAll(".result-block");
        let text = "";

        blocks.forEach(block => {
            const keyword = block.querySelector("strong")?.innerText || "";
            const terms = Array.from(block.querySelectorAll("li")).map(li => li.innerText);
            if (keyword && terms.length) {
                text += `${keyword}\n${terms.join('\n')}\n\n`;
            }
        });

        navigator.clipboard.writeText(text.trim()).then(() => {
            showToast("‚úÖ Results copied to clipboard!");
        });
    }

    function showToast(message) {
        const toast = document.getElementById("toast");
        if (!toast) return;
        toast.textContent = message;
        toast.classList.add("show");
        setTimeout(() => {
            toast.classList.remove("show");
        }, 2500);
    }
</script>
</body>
</html>
